(function(e){function t(t){for(var r,o,n=t[0],c=t[1],l=t[2],d=0,m=[];d<n.length;d++)o=n[d],a[o]&&m.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],r=!0,n=1;n<s.length;n++){var c=s[n];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=s[0]))}return e}var r={},a={app:0},i=[];function o(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=r,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(s,r,function(t){return e[t]}.bind(null,r));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=t,n=n.slice();for(var l=0;l<n.length;l++)t(n[l]);var u=c;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"029f":function(e,t,s){"use strict";var r=s("bb82"),a=s.n(r);a.a},"0b1e":function(e,t,s){},"4e41":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("7f7f"),s("cadf"),s("551c"),s("f751"),s("097d");var r=s("a026"),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},i=[],o=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),n=s("289d"),c=(s("5abe"),s("2f62"));function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}r["a"].use(n["a"]),r["a"].use(c["a"]);var d={name:"buefy_test",data:function(){return{}},computed:u({},Object(c["d"])(["database","user","userFirstName"])),methods:u({},Object(c["c"])(["setLoggedIn","setUser","setUserFirstName"])),created:function(){}},m=d,p=s("2877"),f=Object(p["a"])(m,a,i,!1,null,null,null),v=f.exports,g=s("8c4f"),h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home"},[s("MyHeader"),e.userLoggedIn?e._e():s("div",[s("AnonymousAuth")],1),s("section",{staticClass:"section"},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-3 no-scroll"}),s("div",{staticClass:"column scroll",attrs:{id:"products"}},[s("div",{staticClass:"container"},[s("ProductCards")],1)])])])],1)},C=[],b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("header",[s("section",{staticClass:"hero is-primary is-small"},[s("div",{staticClass:"hero-head"},[s("nav",{staticClass:"navbar"},[s("div",{staticClass:"container"},[e._m(0),s("div",{staticClass:"navbar-menu",attrs:{id:"navbarMenuHeroB"}},[s("div",{staticClass:"navbar-end"},[s("a",{staticClass:"navbar-item",on:{click:e.gotoHome}},[e._v("\n                    Home\n                ")]),s("a",{staticClass:"navbar-item",on:{click:e.incrTest}},[e._v("\n                    Test: "+e._s(e.test)+"\n                ")]),e.customer.mugshotURL?s("a",{staticClass:"navbar-item"},[s("figure",{staticClass:"image is-24x24"},[s("img",{staticClass:"is-rounded",attrs:{src:e.customer.mugshotURL,alt:"mugshot"},on:{click:e.gotoProfile}})])]):e._e(),s("a",{staticClass:"navbar-item",on:{click:e.gotoProfile}},[s("span",[e._v("Hi "+e._s(e.userFirstName))])]),e.userLoggedIn?e._e():s("a",{staticClass:"navbar-item"},[s("span",{on:{click:e.showLoginModal}},[e._v("Login/Register")])]),e.userLoggedIn?s("a",{staticClass:"navbar-item"},[s("span",{on:{click:e.logout}},[e._v("Sign out")])]):e._e(),e._m(1)])])])])]),e._m(2)])]),s("body",[s("div",{staticClass:"container"},[e.loginModalVisible?s("div",{staticClass:"modal is-active"},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-content"},[s("UserLogin",{on:{"close-modal":e.hideLoginModal}}),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:e.hideLoginModal}})],1)]):e._e()])])])},y=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"navbar-brand"},[r("a",{staticClass:"navbar-item"},[r("img",{attrs:{src:s("c316"),alt:"Logo"}})]),r("span",{staticClass:"navbar-burger burger",attrs:{"data-target":"navbarMenuHeroB"}},[r("span"),r("span"),r("span")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"navbar-item"},[s("a",{staticClass:"button is-info is-inverted"},[s("span",{staticClass:"icon"},[s("i",{staticClass:"fab fa-github"})]),s("span",[e._v("Download")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"hero-body"},[s("div",{staticClass:"container has-text-centered"},[s("p",{staticClass:"title"},[e._v("\n                MongoDB Store\n            ")]),s("p",{staticClass:"subtitle"},[e._v("\n                Get it while it's hot!\n            ")])])])}],_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container",attrs:{id:"login"}},[s("div",{staticClass:"notification is-primary"},[s("h1",{staticClass:"title is-2"},[e._v("Log into your existing account")]),s("div",{staticClass:"field is-horizontal"},[s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-expanded"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input",attrs:{type:"email",placeholder:"Email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._m(0)])])]),s("div",{staticClass:"field is-expanded"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.Login(t)},input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._m(1)])])])])]),s("div",{staticClass:"field is-grouped is-grouped-centered"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success is-medium is-focused",on:{click:e.Login}},[e._m(2),s("span",[e._v("Login")])])]),s("p",{staticClass:"control"},[s("router-link",{attrs:{to:"/register"}},[s("button",{staticClass:"button is-medium has-background-grey-lighter"},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-edit"})]),s("span",[e._v("Register a new account")])])])],1)])]),e.error?s("div",{staticClass:"notification is-danger"},[s("strong",[e._v(e._s(e.error))])]):e._e(),e.error?s("div",{staticClass:"notification is-primary"},[s("strong",[e._v(e._s(e.progress))])]):e._e(),e.success?s("div",{staticClass:"notification is-success"},[e._v("\n        "+e._s(e.success)+"\n    ")]):e._e()])},O=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-envelope"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-key"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-check"})])}],w=s("9069");function P(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function j(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?P(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):P(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var E={name:"UserLogin",props:[],data:function(){return{error:"",success:"",progress:"",email:"",password:""}},computed:j({},Object(c["d"])(["stitchClient"])),methods:j({},Object(c["c"])([]),{},Object(c["b"])(["setUserLoggedIn"]),{Login:function(){var e=this;this.error="",this.success="",this.progress="Attempting to log you in...";var t=new w["e"](this.email,this.password);this.stitchClient.auth.loginWithCredential(t).then(function(t){e.$store.dispatch("setUserLoggedIn",t).then(function(){e.progress="This window will close in 2 seconds",e.success="Successfully logged in with id: ".concat(t.id),console.log(e.success);var s=e;setTimeout(function(){s.$emit("close-modal")},2e3)},function(t){e.progress="",e.error="Failed to log in user: ".concat(t.message),console.error(e.error)})},function(t){e.error="Failed to log in user: ".concat(t.message),e.progress="",console.error(e.error)})}}),created:function(){}},k=E,x=Object(p["a"])(k,_,O,!1,null,null,null),$=x.exports;function D(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function S(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?D(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):D(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var L={name:"Header",props:[],components:{UserLogin:$},data:function(){return{loginModalVisible:!1}},computed:S({},Object(c["d"])(["test","stitchClient","customer","userFirstName","userLoggedIn"])),methods:S({},Object(c["c"])(["incrTest","signout"]),{showLoginModal:function(){this.loginModalVisible=!0},hideLoginModal:function(){this.loginModalVisible=!1},gotoProfile:function(){this.userLoggedIn&&this.$router.push({name:"profile"})},gotoHome:function(){this.$router.push({name:"home"})},logout:function(){var e=this;this.stitchClient.auth.logout().then(function(){e.signout()},function(e){console.error("Error: Failed to sign out ".concat(e.message))})}}),created:function(){}},A=L,N=(s("998f"),Object(p["a"])(A,b,y,!1,null,"2c2a682c",null)),I=N.exports,F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div")},U=[];function R(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function M(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?R(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):R(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var H={name:"AnonymousAuth",data:function(){return{error:"",localStitchClient:{}}},computed:M({},Object(c["d"])(["stitchClient","database"])),methods:M({},Object(c["c"])(["setDatabase","setStitchClient"]),{anonymousLogin:function(){var e=this;this.localStitchClient.auth.isLoggedIn||this.localStitchClient.auth.loginWithCredential(new w["a"]).then(function(){}).catch(function(t){e.error="Anonymous Stitch authentication failed: ".concat(t.message),console.error(e.error)})},connectDatabase:function(){try{var e=this.localStitchClient.getServiceClient(w["b"].factory,"mongodb-atlas").db("ecommerce");this.setDatabase(e)}catch(t){this.error="Failed to connect to the database: ".concat(t.message),console.error(this.error)}}}),mounted:function(){this.database||(this.localStitchClient=w["c"].initializeDefaultAppClient("ecommerce-iukkg"),this.setStitchClient(this.localStitchClient),this.anonymousLogin(),this.error?console.error(this.error):this.connectDatabase())}},T=H,z=Object(p["a"])(T,F,U,!1,null,null,null),B=z.exports,W=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("section",{staticClass:"section",attrs:{id:"product-cards"}},[s("ul",{attrs:{id:"product-list"}},e._l(e.products,function(e){return s("li",{key:e.productId},[s("ProductCard",{attrs:{product:e}})],1)}),0)]),s("br"),e.error?s("div",{staticClass:"notification is-danger"},[s("strong",[e._v(e._s(e.error))])]):e._e(),e.success?s("div",{staticClass:"notification is-success"},[e._v("\n      "+e._s(e.success)+"\n  ")]):e._e(),e.progress?s("div",{staticClass:"notification is-primary"},[e._v("\n      "+e._s(e.progress)+"\n  ")]):e._e()])},G=[],V=(s("7514"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"box"},[s("article",{staticClass:"media"},[s("div",{staticClass:"media-left"},[s("figure",{staticClass:"image is-128x128"},[s("img",{attrs:{src:e.product.productImages[0]}})])]),s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("h6",{staticClass:"title is-6"},[e._v(e._s(e.product.productName))]),e.product.category?s("span",{staticClass:"tag"},[e._v(e._s(e.product.category))]):e._e(),s("p",[s("strong",[e._v("$"+e._s(e.product.price.sale))]),e.product.price.list>e.product.price.sale?s("span",[s("small",[e._v(" Reduced from $"+e._s(e.product.price.list))])]):e._e(),s("br"),e._v("\n                    "+e._s(e.productSummary))]),e.product.reviews.numberOfReviews>0?s("div",{staticClass:"columns"},[s("div",{staticClass:"column",attrs:{id:"review-bar"}},[s("progress",{staticClass:"progress is-warning",attrs:{max:"5"},domProps:{value:e.product.reviews.averageReviewScore}})]),s("div",{staticClass:"column is-narrow"},[s("small",[e._v(e._s(e.product.reviews.averageReviewScore)+"/5 ("+e._s(e.product.reviews.numberOfReviews)+" review"),e.product.reviews.numberOfReviews>1?s("span",[e._v("s")]):e._e(),e._v(") ")])])]):e._e()]),e._m(0),e.progress?s("div",{staticClass:"notification is-info"},[e._v("\n                    "+e._s(e.progress)+"\n                ")]):e._e(),e.error?s("div",{staticClass:"notification is-danger"},[s("strong",[e._v(e._s(e.error))])]):e._e(),e.success?s("div",{staticClass:"notification is-success"},[e._v("\n                    "+e._s(e.success)+"\n                ")]):e._e()])])])])}),J=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("nav",{staticClass:"level is-mobile"},[s("div",{staticClass:"level-left"},[s("a",{staticClass:"level-item",attrs:{"aria-label":"reply"}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-reply",attrs:{"aria-hidden":"true"}})])]),s("a",{staticClass:"level-item",attrs:{"aria-label":"retweet"}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-retweet",attrs:{"aria-hidden":"true"}})])]),s("a",{staticClass:"level-item",attrs:{"aria-label":"like"}},[s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-heart",attrs:{"aria-hidden":"true"}})])])])])}];function q(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function K(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?q(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):q(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var Y={name:"ProductCard",props:["product"],components:{},data:function(){return{success:"",progress:"",error:"",productDetails:{productName:"Loading...",productImages:[],price:"--"},productSummary:""}},computed:K({},Object(c["d"])([])),methods:{prepareProductData:function(){this.productSummary=this.product.description.substring(0,252)+"..."}},created:function(){this.prepareProductData()}},Q=Y,X=(s("8bce"),Object(p["a"])(Q,V,J,!1,null,"00ccb78e",null)),Z=X.exports;function ee(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function te(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ee(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ee(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var se={name:"ProductCards",props:[],components:{ProductCard:Z},data:function(){return{error:"",progress:"",success:"",products:[],bouncable:!1,lastProductID:""}},computed:te({},Object(c["d"])(["database"])),methods:{fetchProductList:function(){var e=this;this.error="",this.success="",this.progress="Fetching product list",this.bouncable=!1,this.database.collection("products").find({productID:{$gt:this.lastProductID}},{projection:{_id:0,productID:1,productName:1,description:1,category:1,productImages:1,price:1,"reviews.averageReviewScore":1,"reviews.numberOfReviews":1},sort:{productID:1},limit:20}).toArray().then(function(t){e.lastProductID=t[t.length-1].productID,t.forEach(function(t){e.products.push(t)}),e.progress="";var s=e;setTimeout(function(){s.bouncable=!0},500)},function(t){e.progress="",e.error="Error: Failed to read the list of products – ".concat(t.message),console.error(e.error)})},scroll:function(){var e=this;window.onscroll=function(){var t=750+Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)+window.innerHeight,s=document.documentElement.offsetHeight;t>=s&&e.bouncable&&e.fetchProductList()}}},mounted:function(){this.fetchProductList(),this.scroll()}},re=se,ae=(s("029f"),Object(p["a"])(re,W,G,!1,null,"c7915376",null)),ie=ae.exports;function oe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function ne(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?oe(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):oe(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var ce={name:"home",props:[],components:{AnonymousAuth:B,MyHeader:I,ProductCards:ie},data:function(){return{}},computed:ne({},Object(c["d"])(["userLoggedIn"])),methods:{},mounted:function(){}},le=ce,ue=Object(p["a"])(le,h,C,!1,null,"65dfdb16",null),de=ue.exports,me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"confirm"},[s("MyHeader"),s("ConfirmStitchEmail")],1)},pe=[],fe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("h1",{staticClass:"title is-1"},[e._v("Confirming email address")]),e.error?s("div",{staticClass:"notification is-danger"},[s("strong",[e._v(e._s(e.error))])]):e._e(),e.success?s("div",{staticClass:"notification is-success"},[e._v("\n        "+e._s(e.success)+"\n    ")]):e._e(),e.cta?s("div",{staticClass:"notification is-primary"},[s("div",{staticClass:"content"},[e._v("\n            "+e._s(e.cta)+"                \n        ")])]):e._e()])},ve=[];s("386d");function ge(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function he(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ge(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ge(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var Ce={name:"ConfirmStitchEmail",props:[],data:function(){return{error:"",success:"",cta:""}},computed:he({},Object(c["d"])(["stitchClient"])),created:function(){var e,t=this,s="";try{var r=window.location.search,a=new URLSearchParams(r);e=a.get("token"),s=a.get("tokenId")}catch(o){this.error="Failed to parse URL parameters: ".concat(o.message),console.error(this.error)}try{var i=this.stitchClient.auth.getProviderClient(w["d"].factory);i.confirmUser(e,s).then(function(){t.success="Password confirmed.",t.cta='Return to <router-link to="/">Home page</router-link> and login to continue.'},function(e){t.error="Failed to confirm email address: ".concat(e.message),console.error(t.error)})}catch(o){this.error="Failed to confirm email address: ".concat(o.message),console.error(this.error)}}},be=Ce,ye=Object(p["a"])(be,fe,ve,!1,null,null,null),_e=ye.exports,Oe={name:"confirm",props:[],components:{ConfirmStitchEmail:_e,MyHeader:I},data:function(){},methods:{},mounted:function(){}},we=Oe,Pe=Object(p["a"])(we,me,pe,!1,null,null,null),je=Pe.exports,Ee=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"register"},[s("MyHeader"),s("div",{staticClass:"section"},[s("h1",{staticClass:"title is-2"},[e._v("Register new user")]),s("div",{staticClass:"field is-horizontal"},[e._m(0),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input",attrs:{type:"email",placeholder:"Email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._m(1)])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(2),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-expanded"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._m(3)])])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.password2,expression:"password2"}],staticClass:"input",attrs:{type:"password",placeholder:"Repeat password"},domProps:{value:e.password2},on:{input:function(t){t.target.composing||(e.password2=t.target.value)}}}),e._m(4)])])])]),s("div",{staticClass:"field is-grouped is-grouped-centered"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success",on:{click:e.register}},[e._v("\n                    Register\n                ")])])]),e.error?s("div",{staticClass:"notification is-danger"},[s("strong",[e._v(e._s(e.error))])]):e._e(),e.success?s("div",{staticClass:"notification is-success"},[e._v("\n            "+e._s(e.success)+"\n        ")]):e._e(),e.progress?s("div",{staticClass:"notification is-primary"},[e._v("\n            "+e._s(e.progress)+"\n        ")]):e._e()])],1)},ke=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[e._v("ID")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-envelope"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[e._v("Password")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-key"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-key"})])}];function xe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function $e(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?xe(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):xe(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var De={name:"register",props:[],components:{MyHeader:I},data:function(){return{error:"",success:"",progress:"",email:"",password:"",password2:""}},computed:$e({},Object(c["d"])(["stitchClient"])),methods:$e({},Object(c["c"])(["incrTest"]),{register:function(){var e=this;if(console.log("Registering user"),this.error="",this.progress="",this.password!=this.password2)this.error="Error, passwords must match.";else{this.progress="Registering ".concat(this.email);var t=this.stitchClient.auth.getProviderClient(w["d"].factory);t.registerWithEmail(this.email,this.password).then(function(){e.success="Registration request being processed – check your inbox",e.progress="Returning to main page in 2 seconds";var t=e;setTimeout(function(){t.$router.push({name:"home"})},2e3)},function(t){e.progress="",e.error="Could not register user: ".concat(t.message),console.error(e.error)})}},setUserLoggedIn:function(e){this.setUser(e)}}),mounted:function(){}},Se=De,Le=Object(p["a"])(Se,Ee,ke,!1,null,null,null),Ae=Le.exports,Ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"profile"},[s("MyHeader"),s("div",{staticClass:"section"},[s("div",{staticClass:"container"},[s("h1",{staticClass:"title is-2"},[e._v("User Profile")]),s("div",{staticClass:"field is-horizontal"},[e._m(0),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.name.first,expression:"localCustomer.name.first"}],staticClass:"input",attrs:{type:"name",placeholder:"First"},domProps:{value:e.localCustomer.name.first},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.name,"first",t.target.value)}}}),e._m(1)])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.name.last,expression:"localCustomer.name.last"}],staticClass:"input",attrs:{type:"name",placeholder:"Last"},domProps:{value:e.localCustomer.name.last},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.name,"last",t.target.value)}}}),e._m(2)])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(3),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-expanded"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.phone.mobile,expression:"localCustomer.contact.phone.mobile"}],staticClass:"input",attrs:{type:"tel",placeholder:"Mobile phone number"},domProps:{value:e.localCustomer.contact.phone.mobile},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.phone,"mobile",t.target.value)}}}),e._m(4)])]),s("p",{staticClass:"help"},[e._v("Include +CC")])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.phone.home,expression:"localCustomer.contact.phone.home"}],staticClass:"input",attrs:{type:"tel",placeholder:"Home phone number"},domProps:{value:e.localCustomer.contact.phone.home},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.phone,"home",t.target.value)}}}),e._m(5)]),s("p",{staticClass:"help"},[e._v("Include +CC")])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(6),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field is-expanded"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.phone.work,expression:"localCustomer.contact.phone.work"}],staticClass:"input",attrs:{type:"tel",placeholder:"Work phone number"},domProps:{value:e.localCustomer.contact.phone.work},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.phone,"work",t.target.value)}}}),e._m(7)])]),s("p",{staticClass:"help"},[e._v("Include +CC")])]),s("div",{staticClass:"field is-expanded"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.email,expression:"localCustomer.contact.email"}],staticClass:"input",attrs:{type:"email",placeholder:"Email",disabled:e.localCustomer.contact.email},domProps:{value:e.localCustomer.contact.email},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact,"email",t.target.value)}}}),e._m(8)])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(9),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.deliveryAddress.number,expression:"localCustomer.contact.deliveryAddress.number"}],staticClass:"input",attrs:{type:"text",placeholder:"House name or number"},domProps:{value:e.localCustomer.contact.deliveryAddress.number},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.deliveryAddress,"number",t.target.value)}}}),e._m(10)])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.deliveryAddress.street,expression:"localCustomer.contact.deliveryAddress.street"}],staticClass:"input",attrs:{type:"text",placeholder:"Street name"},domProps:{value:e.localCustomer.contact.deliveryAddress.street},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.deliveryAddress,"street",t.target.value)}}}),e._m(11)])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(12),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.deliveryAddress.city,expression:"localCustomer.contact.deliveryAddress.city"}],staticClass:"input",attrs:{type:"text",placeholder:"Town or city"},domProps:{value:e.localCustomer.contact.deliveryAddress.city},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.deliveryAddress,"city",t.target.value)}}}),e._m(13)])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.deliveryAddress.state,expression:"localCustomer.contact.deliveryAddress.state"}],staticClass:"input",attrs:{type:"text",placeholder:"State"},domProps:{value:e.localCustomer.contact.deliveryAddress.state},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.deliveryAddress,"state",t.target.value)}}}),e._m(14)])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(15),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.deliveryAddress.postalCode,expression:"localCustomer.contact.deliveryAddress.postalCode"}],staticClass:"input",attrs:{type:"text",placeholder:"Postal code"},domProps:{value:e.localCustomer.contact.deliveryAddress.postalCode},on:{input:function(t){t.target.composing||e.$set(e.localCustomer.contact.deliveryAddress,"postalCode",t.target.value)}}}),e._m(16)])]),e._m(17),s("div",{staticClass:"field"},[s("div",{staticClass:"control is-expanded has-icons-left"},[s("div",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.contact.deliveryAddress.country,expression:"localCustomer.contact.deliveryAddress.country"}],staticClass:"input",attrs:{type:"text",placeholder:"Country"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.localCustomer.contact.deliveryAddress,"country",t.target.multiple?s:s[0])}}},[s("option",{attrs:{selected:"",value:""}},[e._v("Country")]),e._l(e.countries,function(t){return s("option",{key:t.name},[e._v(e._s(t.name))])})],2)]),e._m(18)])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(19),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("label",{staticClass:"checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.marketingPreferences.email,expression:"localCustomer.marketingPreferences.email"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.localCustomer.marketingPreferences.email)?e._i(e.localCustomer.marketingPreferences.email,null)>-1:e.localCustomer.marketingPreferences.email},on:{change:function(t){var s=e.localCustomer.marketingPreferences.email,r=t.target,a=!!r.checked;if(Array.isArray(s)){var i=null,o=e._i(s,i);r.checked?o<0&&e.$set(e.localCustomer.marketingPreferences,"email",s.concat([i])):o>-1&&e.$set(e.localCustomer.marketingPreferences,"email",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.localCustomer.marketingPreferences,"email",a)}}}),e._v("\n                            I agree to receive notifications by email\n                        ")])]),s("div",{staticClass:"field"},[s("label",{staticClass:"checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.marketingPreferences.sms,expression:"localCustomer.marketingPreferences.sms"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.localCustomer.marketingPreferences.sms)?e._i(e.localCustomer.marketingPreferences.sms,null)>-1:e.localCustomer.marketingPreferences.sms},on:{change:function(t){var s=e.localCustomer.marketingPreferences.sms,r=t.target,a=!!r.checked;if(Array.isArray(s)){var i=null,o=e._i(s,i);r.checked?o<0&&e.$set(e.localCustomer.marketingPreferences,"sms",s.concat([i])):o>-1&&e.$set(e.localCustomer.marketingPreferences,"sms",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.localCustomer.marketingPreferences,"sms",a)}}}),e._v("\n                            I agree to receive notifications by SMS text message\n                        ")])])])]),s("div",{staticClass:"field is-horizontal"},[e._m(20),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("div",{staticClass:"file has-name"},[s("label",{staticClass:"file-label"},[s("input",{staticClass:"file-input",attrs:{type:"file",name:"resume"},on:{change:e.uploadMugshot}}),e._m(21),s("span",{staticClass:"file-name"},[e._v("\n                                    "+e._s(e.mugshotFile.name)+"\n                                ")])])])]),s("div",{staticClass:"field"},[s("p",{staticClass:"control is-expanded has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.localCustomer.mugshotURL,expression:"localCustomer.mugshotURL"}],staticClass:"input",attrs:{type:"url",placeholder:"Mugshot image URL"},domProps:{value:e.localCustomer.mugshotURL},on:{input:function(t){t.target.composing||e.$set(e.localCustomer,"mugshotURL",t.target.value)}}}),e._m(22)])]),e.localCustomer.mugshotURL?s("div",{staticClass:"field"},[s("figure",{staticClass:"image is-128x128"},[s("img",{attrs:{src:e.localCustomer.mugshotURL}})])]):e._e()])]),s("div",{staticClass:"field is-grouped is-grouped-centered"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success",on:{click:e.saveProfile}},[e._v("\n                        Save Profile\n                    ")])])]),e.progress?s("div",{staticClass:"notification is-info"},[e._v("\n                "+e._s(e.progress)+"\n            ")]):e._e(),e.error?s("div",{staticClass:"notification is-danger"},[s("strong",[e._v(e._s(e.error))])]):e._e(),e.success?s("div",{staticClass:"notification is-success"},[e._v("\n                "+e._s(e.success)+"\n            ")]):e._e()])])],1)},Ie=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[e._v("Name")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-user"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-user"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[e._v("Contact")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-phone"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-phone"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-phone"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-envelope"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[e._v("Delivery address")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-home"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-road"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-building"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-map"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-map-pin"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dropdown is-active"},[s("div",{staticClass:"dropdown-trigger"},[s("button",{staticClass:"button",attrs:{"aria-haspopup":"true","aria-controls":"dropdown-menu"}},[s("span",[e._v("Country")]),s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-angle-down",attrs:{"aria-hidden":"true"}})])])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-globe"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[e._v("Marketing preferences")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label is-normal"},[s("label",{staticClass:"label"},[e._v("Headshot")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"file-cta"},[s("span",{staticClass:"file-icon"},[s("i",{staticClass:"fas fa-upload"})]),s("span",{staticClass:"file-label"},[e._v("\n                                    Upload a mugshot image…\n                                ")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-link"})])}],Fe=(s("34ef"),s("7c53")),Ue=s("9e8e");function Re(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Me(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Re(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Re(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var He={name:"profile",props:[],components:{MyHeader:I},data:function(){return{error:"",success:"",progress:"",localCustomer:{},countries:[],mugshotFile:{}}},computed:Me({},Object(c["d"])(["stitchClient","database","userLoggedIn","userFirstName","customer","user"])),methods:Me({},Object(c["c"])(["setCustomer","setUserFirstName"]),{getCountriesList:function(){var e=this;this.stitchClient.callFunction("getCountriesList").then(function(t){e.countries=t},function(e){console.error("Error: failed to fetch country list: ".concat(e.message))})},fetchCustomer:function(){var e=this;this.progress="Looking for existing user profile.",this.database.collection("customers").findOne({"contact.email":this.user.profile.data.email}).then(function(t){t?(e.localCustomer=t,e.progress=""):e.progress=""},function(e){console.error("Error: attempt to read customer document failed: ".concat(e.message))})},saveProfile:function(){var e=this;this.progress="Writing profile to database.",this.error="",this.success="",this.database.collection("customers").updateOne({"contact.email":this.localCustomer.contact.email},this.localCustomer,{upsert:!0}).then(function(){e.progress="",e.setCustomer(e.localCustomer),e.localCustomer.name.first&&e.setUserFirstName(e.localCustomer.name.first),e.success="User profile updated.",e.progress="Returning to main page in 2 seconds";var t=e;setTimeout(function(){t.$router.push({name:"home"})},2e3)},function(t){e.progress="",e.error="Error: Writing profile to the database - ".concat(t.message),console.error(e.error)})},convertImageToBSON:function(e){return new Promise(function(t){var s=new FileReader;s.onload=function(e){var s=new Ue["b"].Binary(new Uint8Array(e.target.result));t(s)},s.readAsArrayBuffer(e)})},uploadMugshot:function(e){var t=this;this.error="",this.progress="",this.success="";var s=e.target.files||e.dataTransfer.files;if(s.length){this.mugshotFile=s[0];var r=this.stitchClient.getServiceClient(Fe["b"].factory,"AWS");this.convertImageToBSON(this.mugshotFile).then(function(e){var s=Date.now(),a={ACL:"public-read",Bucket:"clusterdb-ecommerce-mugshots",ContentType:t.mugshotFile.type,Key:"mug_".concat(t.customer.contact.email,"_").concat(s),Body:e},i=(new Fe["a"].Builder).withService("s3").withAction("PutObject").withArgs(a);r.execute(i.build()).then(function(){t.customer.mugshotURL="https://clusterdb-ecommerce-mugshots.s3.amazonaws.com/mug_".concat(t.customer.contact.email,"_").concat(s)},function(e){t.error="Failed to upload image file: ".concat(e.message)})},function(e){t.error="Error: Failed to convert image file: ".concat(e.messahge,".")})}else this.error="Failed to select a file"}}),created:function(){this.getCountriesList(),this.userLoggedIn?(this.localCustomer=this.customer,this.localCustomer.owner_id=this.stitchClient.auth.user.id,this.localCustomer.contact.email=this.user.profile.data.email,this.fetchCustomer(),this.originalEmail=this.localCustomer.contact.email):(this.error="Cannot access customer profile until user is logged in",console.error(this.error))}},Te=He,ze=Object(p["a"])(Te,Ne,Ie,!1,null,null,null),Be=ze.exports,We=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.userLoggedIn?e._e():s("div",[s("AnonymousAuth")],1),s("ul",{attrs:{id:"category-list"}},e._l(e.categories,function(t){return s("li",{key:t},[e._v("\n      "+e._s(t)+"           \n  ")])}),0)])},Ge=[];function Ve(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Je(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ve(s,!0).forEach(function(t){Object(o["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ve(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var qe={name:"test",props:[],components:{AnonymousAuth:B},data:function(){return{categories:["numpty","fish"],categoryHierarchies:[]}},computed:Je({},Object(c["d"])(["userLoggedIn","database"])),methods:{populateCategoryTree:function(){var e=this,t=this.database.collection("products");console.log("Fetching product categories");try{t.find({},{projection:{categoryHierarchy:1}}).toArray().then(function(t){console.log("".concat(t.length," elements")),t.forEach(function(t){e.categoryHierarchies.push(t.categoryHierarchy)},function(e){console.error("Processing product failed: ".concat(e.message))})},function(e){console.error("Find failed: ".concat(e.message))})}catch(s){console.error("Failed building category tree: ".concat(s.message))}}},mounted:function(){this.populateCategoryTree()}},Ke=qe,Ye=(s("8eb3"),Object(p["a"])(Ke,We,Ge,!1,null,"45eb7768",null)),Qe=Ye.exports;r["a"].use(g["a"]);var Xe=new g["a"]({routes:[{path:"/",name:"home",component:de,props:!0},{path:"/confirm",name:"confirm",component:je,props:!0},{path:"/register",name:"register",component:Ae,props:!0},{path:"/profile",name:"profile",component:Be,props:!0},{path:"/test",name:"test",component:Qe,props:!0}]});r["a"].config.productionTip=!1;var Ze={name:{title:"",first:"",last:""},contact:{email:"",phone:{home:"",work:"",mobile:""},deliveryAddress:{number:"",street:"",city:"",state:"",postalCode:"",country:""}}},et=new c["a"].Store({state:{stitchClient:{},database:null,userLoggedIn:!1,userFirstName:"Guest",user:null,customer:{name:{title:"",first:"",last:""},contact:{email:"",phone:{home:"",work:"",mobile:""},deliveryAddress:{number:"",street:"",city:"",state:"",postalCode:"",country:""}},marketingPreferences:{email:!1,sms:!1}},test:42},getters:{},mutations:{incrTest:function(e){e.test++},setStitchClient:function(e,t){e.stitchClient=t},setDatabase:function(e,t){e.database=t},setLoggedIn:function(e,t){e.userLoggedIn=t},setUserFirstName:function(e,t){e.userFirstName=t},setUser:function(e,t){e.user=t},setCustomer:function(e,t){e.customer=t},signout:function(e){e.customer=Ze,e.user=null,e.userLoggedIn=!1,e.userFirstName="Guest"}},actions:{setUserLoggedIn:function(e,t){var s=e.commit,r=e.state;return s("setLoggedIn",!0),s("setUser",t),t.profile.firstName?s("setUserFirstName",t.profile.firstName):t.profile.email&&s("setUserFirstName",t.profile.email),new Promise(function(e,t){try{r.database.collection("customers").findOne({"contact.email":r.user.profile.data.email}).then(function(t){t?(s("setCustomer",t),s("setUserFirstName",t.name.first)):console.log("No matching customer document found in the database."),e()},function(e){console.error("Error: attempt to read customer document failed: ".concat(e.message)),t({message:"Error: attempt to read customer document failed: ".concat(e.message)})})}catch(a){console.error("Error: Call to fetch customer document failed: ".concat(a.message)),t({message:"Error: Call to fetch customer document failed: ".concat(a.message)})}})}}});new r["a"]({router:Xe,store:et,data:{},computed:{},render:function(e){return e(v)}}).$mount("#app")},"5b7e":function(e,t,s){},"8bce":function(e,t,s){"use strict";var r=s("4e41"),a=s.n(r);a.a},"8eb3":function(e,t,s){"use strict";var r=s("0b1e"),a=s.n(r);a.a},"998f":function(e,t,s){"use strict";var r=s("5b7e"),a=s.n(r);a.a},bb82:function(e,t,s){},c316:function(e,t,s){e.exports=s.p+"img/MongoDB_Logo_White_RGB.e2701f1d.png"}});
//# sourceMappingURL=app.f493be7a.js.map